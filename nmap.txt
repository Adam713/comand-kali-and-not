
1- TCP connect: وهو أبسط الأساليب المستخدمة في فحص المنافذ ويستعمل في أنظمة Unix للبدء باتصال TCP ويمكننا استخدامه بتنفيذ الأمر التالي:
arp-scan -l
كود:
 nmap -sP 10.2.160.1/24
nmap -sS 192.168.88.1/24
nmap -sV 192.168.88.1/24

 nmap -A 192.168.88.1
	
nmap -sT 192.168.0.1
بفرض أن 192.168.0.1 هو الجهاز الذي نريد فحصه وبهذه الحالة سيحاول برنامج Nmap الاتصال بالجهاز بطريقة عادية فمثلا اذا تمكن برنامج Nmap من الاتصال بالمنفذ 21 هذا يعني ان خدمة الـ FTP تعمل على الجهاز كون المنفذ 21 هو المنفذ الافتراضي الخاص بخدمة الـ FTP مع العلم أن مدير السيرفر يستطيع تغيير المنفذ الافتراضي لأي خدمة يريد وبهذه الحالة سنعتمد على الـ Header الخاص بالخدمة لمعرفة المنفذ الذي تعمل عليه.

2- SYN Stealth Scan: أكثر الأساليب انتشارا في فحص المنافذ ويدعى أيضا half-open scanning لأنه لن يقوم بعمل اتصال TCP كامل فعوضا عن استخدام TCP connect والاعتماد على النظام في انشاء اتصال ستقوم أداة Nmap بانشاء وارسال Packet من نوع SYN وهي الـ Packet الخاصة ببدأ اتصال مع النظام وفي حال حصلنا على رد من النظام الذي نقوم بفحصة (Packet من نوع SYN-ACK) هذا يعني أن المنفذ مفتوح ويمكننا استخدامه بتنفيذ الأمر التالي (سنحتاج لصلاحيات root):

كود:
nmap -v 192.168.88.1

	
nmap -sS 192.168.0.13- UDP Scan
: في هذا الأسلوب سيقوم برنامج Nmap بارسال UDP Packet فارغة (0-byte) وينتظر الرد من الجهاز الذي نقوم بفحصه فاذا لم نحصل على رد هذا يعني أن المنفذ مفتوح أما اذا كان المنفذ مغلق فسيرسل لنا الجهاز Packet من نوع ICMP تخبرنا أن المنفذ مغلق مع العلم أنه اذا كان المنفذ محظور من الجدار الناري سيظهر لنا أن المنفذ مفتوح أما اذا تم حظر الرد (ICMP Packet) فسيظهر لنا أن جميع المنافذ مفتوحة! يمكننا استخدام هذا الأسلوب بتنفيذ الأمر التالي:

كود:
1
	
nmap -sU 192.168.0.14- ACK Scan
: نستخدم هذا الأسلوب في اكتشاف قوانين الجدار الناري ومعرفة اذا كان المنفذ الذي نفحصه مفلتر أم لا حيث سيقوم برنامج Nmap بارسال Packet من نوع ACK عوضا عن SYN وهذا أمر خاطئ فالاتصال يبدأ بـ SYN وليس بـ ACK لذلك سيقوم الجاهز الذي نفحصه بارسال Packet من نوع RST لاعادة الاتصال وبهذه الحالة نعلم أن المنفذ غير مفلتر ولا يوجد جدار ناري يمنع ارسال Packet من نوع RST أما اذا كان يوجد جدار ناري فلن نحصل على اي رد وهكذا نعلم أن المنفذ مفلتر (filtered) مع العلم أن هذا الأسلوب لن يظهر لنا ان كان المنفذ مفتوح أم مغلق ولكنه سيظهر ان كان المنفذ مفلتر أم لا, نستخدم هذا الأسلوب بتنفيذ الأمر:

كود:
1
	
nmap -sA -p 80 192.168.0.1
استخدمنا الأمر السابق بفرض أن 192.168.0.1 هو الجهاز الذي نفحصه و 80 هو المنفذ الذي نختبره.

5- IP Protocol Scan: في هذا الأسلوب يختلف عن الأساليب السابقة حيث سيقوم برنامج Nmap بارسال IP Packet للبروتوكولات الموجودة في الجهاز فاذا كان البروتوكول غير مستخدم سيقوم الجهاز بارسال رد عبارة عن Packet من نوع ICMP تخبرنا بذلك بغير هذه الحالة هذا يعني أن البروتوكول مستخدم, يمكننا استخدام هذا الأسلوب بتنفيذ الأمر التالي:

كود:
1
	
nmap -sO 192.168.0.16- Version Detection Scan
: يمكننا هذا الأسلوب من فحص المنافذ المفتوحة ومعرفة الخدمات التي تعمل وتحديد اصداراتها أيضا حيث سيقوم برنامج Nmap بجمع معلومات عن الخدمات التي تعمل بالنظام الذي نفحصه ويفيدنا باكتشاف الثغرات الموجودة فبمجرد معرفتنا للخدمات التي تعمل في النظام وتحديد اصداراتها يمكننا استخدام مشروع ثغرات ****sploit مثلا أو استغلال أي ثغرة remote لاختراق النظام عن بعد (Black Hat Hackers Wins!) يمكننا استخدام هذا الأسلوب بتنفيذ الأمر التالي:

كود:
1
	
nmap -sV 192.168.0.17- Ping Scan
: نستفيد من هذا الأسلوب في فحص نطاق شبكة ومعرفة اذا كان الجهاز يعمل أم لا حيث سيقوم برنامج Nmap بارسال Packet من نوع ICMP وهي نفسها التي نقوم بارسالها عندما ننفذ الأمر ping للتأكد ان كان الجهاز موجود بالشبكة اذا وصلنا رد من الجهاز هذا يعني أن الجهاز يعمل أما في حال لم نحصل على أي رد بسبب وجود جدار ناري يحجب الـ ICMP Packet مثلا سيقوم برنامج Nmap بعمل TCP Ping فاذا حصلنا على رد من نوع RST أو ACK هذا يعني أن الجهاز يعمل بغير هذه الحالة يعني أن النظام لا يعمل أو أن المنفذ الذي اخترناه مفلتر, يمكننا استخدام هذا الأسلوب بتنفيذ الأمر:

كود:
1
	
nmap -sP 192.168.0.1-255
ليفحص جميع الأجهزة الموجودة في النطاق 192.168.0.1 وحتى 192.168.0.225 أو عن طريق الأمر:

كود:
1
	
nmap -sP 192.168.0.1/24
هذا الأمر مثل الأمر السابق تماما فبما أن النطاق Class C هذا يعني أن الـ Netmask: 255.255.255.0 وهذا سيعطينا نفس النطاق السابق, أما اذا أردنا اختيار منفذ محدد ليتم فحصه مثلا 80 وهو المنفذ الافتراضي الخاص بالـ ***server, نستخدم الأمر التالي:

كود:
1
	
nmap -sP -p 80 192.168.0.1-255
يحتوي برنامج Nmap على خيارات أخرى كثيرة ويمكننا استخدامهم مع بعض بالشكل الذي نريد فمثلا لنفرض أننا نريد فحص المنافذ التالية فقط (21,22,53,80) بجميع الأجهزة الموجودة بالشبكة, اذاً كل ماعلينا هو تنفيذ الأمر التالي:

كود:
1
	
nmap -sS -p 21,22,53,80 192.168.0.1-255
يمكننا كذلك اضافة -v لجعل عملية الفحص بشكل مرئي أمامنا فهي تفيدنا في حال فحص نطاق شبكة كبير مثلا أو لأننا لم نرغب بالانتظار حتى النهاية لمشاهدة جميع النتائج, نقوم بذلك بتنفيذ الأمر:

كود:
1
	
nmap -sS -v -p 21,22,53,80 192.168.0.1-255
لنفرض أننا نريد فحص المنافذ المفتوحة في الجهاز الذي نستخدمه من المنفذ رقم 1 وحتى 100:

كود:
1
	
nmap -sS -p 1-100 127.0.0.1
من ميزات برنامج Nmap أيضا قدرته على معرفة نظام التشغيل عن بعد, كل ماعلينا هو استخدام الأمر التالي لعمل Remote OS Fingerprint:

كود:
1
	
nmap -O -v 192.168.0.1
أو يمكننا استخدام أمر أكثر شمولية يجمع لنا معلومات عن النظام وجميع الخدمات التي تعمل عليه باستخدام الأمر التالي:

كود:
1
	
nmap -sS -A 192.168.0.1
طبعا كما قلت سابقا يمكننا استخدام جميع الأوامر السابقة مع بعضها البعض فمثلا ان أردنا من البرنامج تحديد نوعية التظام وجمع معلومات عن المنفذ 80 فقط نستطيع تنفيذ الأمر:

كود:
1
	
nmap -sS -A -p 80 192.168.0.1
ومن خيارات برنامج Nmap أيضا هو الفحص السريع حيث يقوم البرنامج بفحص المنافذ الأكثر شهرة فقط, نستفيد منه في حال قيامنا بفحص عدد كبير من الأجهزة ويمكننا استخدامه بتنفيذ الأمر:

كود:
1
	
nmap -sS -F 192.168.0.1-255
ويستطيع برنامج Nmap تصدير نتائج الفحص الى ملف خارجي بسهولة, باستخدام احدى الأوامر التالية:

كود:
1
	
nmap -sS -oN log.txt 192.168.0.1
مدير الشبكة, لنفرض مثلا أننا نريد فحص السيرفر الموجود في الشبكة لكن أغلبنا يعلم اذا كان مدير الشبكة شخص محترف أو يستخدم IDS مثلا يمكنه وبكل سهولة اكتشاف من يقوم بفحص المنافذ لذلك يمكننا استخدام الأمر:

كود:
1
	
nmap -sS -f 192.168.0.1
لأمر السابق سيقوم بتجزئة الـ IP Packet لعدة أقسام عند ارسالها مما سيصعب أمر تجميعها على الجدار الناري أو يمكننا استخدام خيار أكثر خطورة مثل:

كود:
1
	
nmap -sS -D 192.168.0.2, 192.168.0.3, 192.168.0.4 192.168.0.1
الخيار السابق سيجعل الأدمن يظن أن الآيبيات التالية: 192.168.0.2 + 192.168.0.3 + 192.168.0.4 بالاضافة لآيبي الجهاز الذي نستخدمه جميعهم يقومون بفحص السيرفر وبهذه الحالة لن يعرف من هو الشخص الحقيقي الذي يقوم بعملية الفحص!
nmap -sS -sV -p- 192.168.0.1 -v -o metasploitable2.txt

